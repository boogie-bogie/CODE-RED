<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>WebSocket Client Example</title>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <style>
      #message-container {
        border: 1px solid #ddd;
        padding: 10px;
        margin-bottom: 10px;
        height: 300px;
        overflow-y: auto;
      }
      #message-form {
        display: flex;
      }
      #message-input {
        flex-grow: 1;
        margin-right: 10px;
      }
    </style>
  </head>
  <body>
    <h1>WebSocket Client Example</h1>
    <div id="message-container"></div>
    <form id="message-form">
      <input type="text" id="message-input" placeholder="메시지를 입력하세요" />
      <button>전송</button>
    </form>
    <script type="text/javascript">
      const socket = io('/chat'); //socket.io 연결

      const messageContainer = document.getElementById('message-container');
      const messageForm = document.getElementById('message-form');
      const messageInput = document.getElementById('message-input');

      messageForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const message = messageInput.value;
        socket.emit('message', { data: message });
        messageInput.value = ''; // 메세지 입력 창 초기화
      });

      socket.on('message', (data) => {
        const messageElement = document.createElement('div');
        const messageText = data.message.data; // input 창에 있는 글만 가져옴

        messageElement.textContent = messageText; // 문자열만 출력, 새로운 요소로 문자열 받음
        messageContainer.appendChild(messageElement); // 컨테이너에 메세지 요소 추가
        messageContainer.scrollTop = messageContainer.scrollHeight; // 스크롤 자동으로 아래로 이동
      });
    </script>
  </body>
</html>
